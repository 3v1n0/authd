> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: r
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: r
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: invalid-ID
PAM Error Message: Provided input can't be parsed as integer value
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: r
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: invalid-ID
PAM Error Message: Provided input can't be parsed as integer value
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 555
PAM Error Message: Invalid entry. Try again or input 'r'.
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: r
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: invalid-ID
PAM Error Message: Provided input can't be parsed as integer value
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 555
PAM Error Message: Invalid entry. Try again or input 'r'.
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 1
auth=incomplete
PAM Authenticate() for user "user-integration-switch-broker" exited with error (PAM exit code: 2
5): The return value should be ignored by PAM dispatch
PAM AcctMgmt() exited with error (PAM exit code: 26): Critical error - immediate abort
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-integration-switch-broker
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-integration-switch-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: r
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: invalid-ID
PAM Error Message: Provided input can't be parsed as integer value
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 555
PAM Error Message: Invalid entry. Try again or input 'r'.
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 1
auth=incomplete
PAM Authenticate() for user "user-integration-switch-broker" exited with error (PAM exit code: 2
5): The return value should be ignored by PAM dispatch
PAM AcctMgmt() exited with error (PAM exit code: 26): Critical error - immediate abort
>
────────────────────────────────────────────────────────────────────────────────
