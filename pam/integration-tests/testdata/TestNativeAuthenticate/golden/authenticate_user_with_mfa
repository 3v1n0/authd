> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 2
Press Enter to wait for authentication or enter 'r' to go back
Unlock your phone +33… or accept request on web interface:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 2
Press Enter to wait for authentication or enter 'r' to go back
Unlock your phone +33… or accept request on web interface:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 2
Press Enter to wait for authentication or enter 'r' to go back
Unlock your phone +33… or accept request on web interface:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
PAM Authenticate() for user "user-mfa" exited with success
PAM AcctMgmt() exited with success
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 2
Press Enter to wait for authentication or enter 'r' to go back
Unlock your phone +33… or accept request on web interface:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
PAM Authenticate() for user "user-mfa" exited with success
PAM AcctMgmt() exited with success
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TESTS_CLI_AUTHENTICATE_TESTS_SOCK} force_native_client=true
Username: user-mfa
== Provider selection (enter 'r' to go back) ==
  1. local
  2. ExampleBroker
Choose your provider: 2
Enter 'r' to cancel the request and go back
Gimme your password:
== Authentication method selection (enter 'r' to go back) ==
  1. Password authentication
  2. Send URL to user-mfa@gmail.com
  3. Use your fido device foo
  4. Use your phone +33…
  5. Use your phone +1…
  6. Pin code
  7. Use a QR code
  8. Authentication code
Choose your authentication method: 1
Enter 'r' to cancel the request and go back
Gimme your password:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 1
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb: r
== Authentication method selection (enter 'r' to go back) ==
  1. Use your fido device foo
  2. Use your phone +33…
  3. Authentication code
Choose your authentication method: 2
Press Enter to wait for authentication or enter 'r' to go back
Unlock your phone +33… or accept request on web interface:
Press Enter to wait for authentication or enter 'r' to go back
Plug your fido device and press with your thumb:
PAM Authenticate() for user "user-mfa" exited with success
PAM AcctMgmt() exited with success
>
────────────────────────────────────────────────────────────────────────────────
